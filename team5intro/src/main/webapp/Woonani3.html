<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	
	
	<style type="text/css">
		body {
			overflow:scroll;
			margin-top:100px;
			margin-bottom: 30px;
			/* text-align: center; */
		}
		.contents-1  {
			margin: 30px;
			clear: both;
		}
		/* li {
			display: inline;
		} */
		
		.function-box {
			 background-color: rgba(145, 186, 255, 0.3);
			 border-radius: 10px;
			 float: left;
			 height : 300px;
			 margin: 25px;
			 padding: 35px;
			 text-align: center;
			 width: 400px;
		}
		.function-box button {
			 background-color: rgba(255, 255, 255, 0.7);
			 border-radius: 10px;
			 text-align: center;
			 margin: 10px 0px;
		}
		
		.contents-main button {
		  width: 100%;
		}
		
		
		
    </style>
    <script type="text/javascript">
	    window.onload = function(){
	    	
		    var cards = document.querySelectorAll('.card'); 		//.card를 가진 elements 배열
		    
		    var dropzones = document.querySelectorAll('.dropzone');	//.dropzone을 가진 elements 배열
		    	
	    	// cards.forEach(function(card){})
	    	// 와 같은 함수를 Arrow Function으로..
	    	
	    	// https://yuddomack.tistory.com/entry/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8 -Array-forEach
	    	// forEach문 -> JS Ex43_..
	    	// drag할 card들 event attach
	    	cards.forEach(card => {
	    		card.addEventListener("dragstart", dragStart);
	    		card.addEventListener("drag", drag);				// drag 여러번 발생
	    		card.addEventListener("dragend", dragEnd);
	    	});
	    	
	    	/*---------- .card : Drag 요소 함수들 ----------*/ 
	    	
	    	function dragStart(){
	    		//console.log("카드 : dragstart" );
	    		dropzones.forEach(dropzone => dropzone.classList.add("highlight"));
	    		//console.log(dropzones[0].classList); // DOMTokenList(2) ['dropzone', 'highlight', value: 'dropzone highlight']
	    		
	    		// this = card
	    		this.classList.add('is-dragging');
	    	}
	    	
	    	function drag(){
	    		console.log("카드 : dragging" );
	    		// this = card
	    	}
	    	
	    	function dragEnd(){
	    		console.log("카드 : drag end" );
	    		dropzones.forEach(dropzone => dropzone.classList.remove("highlight"));
	    		
	    		// this = card
	    		this.classList.remove('is-dragging');
	    	}
	    	
	    	
	    	
	    	dropzones.forEach(dropzone => {
	    		dropzone.addEventListener("dragenter", dragEnter);
	    		dropzone.addEventListener("dragover", dragOver);	// dragOver 여러번 발생
	    		dropzone.addEventListener("dragleave", dragLeave);
	    		dropzone.addEventListener("drop", drop);
	    	});
	    	
	    	/*---------- .dropzone : Drop 요소 함수들 ----------*/
	    	
	    	function dragEnter(){
	    		//console.log("드랍 : dragEnter");
	    		//this = dropzone
	    	}
	    	
	    	function dragOver(){
	    		//console.log("드랍 : dragOver");
	    		//this = dropzone
	    		//console.log(this);
	    		this.classList.add('dragover');
	    		
	    		var cardOn = document.querySelector(".is-dragging");	// drag중인 단일 card
	    		
	    		this.appendChild(cardOn);
	    	}
	    	
	    	function dragLeave(){
	    		//console.log("드랍 : dragLeave");
	    		this.classList.remove('dragover');
	    		
	    		//this = dropzone
	    	}
	    	
	    	function drop(){
	    		//console.log("드랍 : drop");
	    		//this = dropzone
	    		this.classList.remove('dragover');
	    	}
	    }
    </script>

</head>
<body>

	
	
	
	<!-- contents -->
	<div class="contents-main" >
	
		
		
	
		<div class="contents-1">
			<h1>#1 </h1>
			<input id="inputToDo" type="text" placeholder="할일을 적어주세요"> 
			<input id="btnToDo" type="button" value="등록"><br>		
			
			<div class="function-box" id="function-box1">
				<h4>To Do List</h4><br><br>
				<div class="toDoBox">

				</div>
				
			</div>
			
			<div class="function-box" id="function-box2">
				<h4>In Progress</h4><br><br>
				<div id="dragdiv" draggable="true" ondragstart="drag(event)"><i class="bi bi-apple"></i> Drag Me!</div>
				<div id="dropdiv" ondrop="drop(event)" ondragover="allowDrop(event)"><i class="bi bi-arrow-90deg-down"></i> Drop Here!<br></div>
				<br><br>
			</div>
			
			<div class="function-box" id="function-box3">
				<h4>Done</h4><br> 
				
			</div>
		</div>

		<script>
			let toDoList =[];
			let progressList =[];
			let doneList =[];

			window.onload = ()=> {
				setToDoTags( "toDoList", ".toDoBox" )
				setToDoTags( "progressList", ".progressBox" )
				setToDoTags( "doneList", ".doneBox" )				
			}

			// To Do List 할일 추가 이벤트함수
			document.getElementById("btnToDo").addEventListener("click", ()=>{
				let inputValue = document.getElementById("inputToDo").value;
				if(inputValue.trim().length <1){
					window.alert("빈내용은 제출 안됨^^");
				}else{
					let newToDo = document.getElementById("inputToDo").value;
					let newToDoTag = document.createElement("p");
					newToDoTag.innerHTML = newToDo;
					document.querySelector(".toDoBox").appendChild(newToDoTag);

					// toDoList 배열에 추가하고 LocalStorage에 담는다.					
					toDoList=JSON.parse(localStorage.getItem("toDoList")); // toDoList.push(newToDo); // X!! 전역변수 toDoList에 LocalStorage정보가 저장되어있지 않다.
					toDoList.push(newToDo);
					localStorage.setItem("toDoList", JSON.stringify(toDoList));	
					document.getElementById("inputToDo").value = "";
				}
			})	
			
			// toDoList 추가 시 enter키로 제출하는 함수
			document.getElementById("inputToDo").addEventListener("keyup", (e)=>{
				if(e.keyCode === 13){
					event.preventDefault();
					document.getElementById("btnToDo").click();
				}
			})

			// LocalStorage에서 자료를 꺼내와 ListBox에 태그생성하는 함수
			function setToDoTags( listName, boxClassName ) {
				if( localStorage.getItem(listName) == null){
					localStorage.setItem(listName, "[]");
				}else{
					listName = JSON.parse(localStorage.getItem(listName));
					listName.forEach((v)=>{
						makeToDoTag (v, boxClassName);
					})
				}
			}

			// to Do 태그 생성 함수 
			function makeToDoTag (toDoTxt, boxClassName){
				let toDoTag = document.createElement("p");
						toDoTag.innerHTML = toDoTxt;
						document.querySelector(boxClassName ).appendChild(toDoTag)
			}

		</script>	
			<!-- In Progress 존 -->
			<div class="board">
				<h3>In Progress</h3>
				<div class="dropzone">
				
					<div class="card" draggable="true"><div class="status yellow"></div>
						<div class="content"> Javascript </div>
					</div>
					
					<div class="card" draggable="true"><div class="status yellow"></div>
						<div class="content"> Jquery </div>
					</div>
					
					<div class="card" draggable="true"><div class="status yellow"></div>
						<div class="content"> JSP </div>
					</div>
					
					<div class="card" draggable="true"><div class="status yellow"></div>
						<div class="content"> Assignment </div>
					</div>
					
				</div>
			</div>
			
			<!-- Done 존 -->
			<div class="board">
				<h3>Done</h3>
				<div class="dropzone">
				
					<div class="card" draggable="true"><div class="status red"></div>
						<div class="content"> next level! </div>
					</div>
					
					<div class="card" draggable="true"><div class="status red"></div>
						<div class="content"> next level! </div>
					</div>
					
				</div>
			</div>
		</div>
			<br><br><hr><br><br>
		</div>

		
	
	</div>
	
	
	<!-- contents End -->
	
	
	
	<!-- Footer -->
	<!-- button footer -->
	<footer class=" text-center text-white fixed-bottom "  style="background-color: rgba(0, 0, 0, 0);">	
	
	    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0); margin-bottom: -5px" >
	            <a class="btn btn-outline-light btn-floating s-1" style="border-radius: 50%; color: white; background-color: #3B71CA; "  href="#" role="button"><i class="bi bi-chevron-double-up"></i></a>
	            <!-- <a class="btn  m-1" href="https://github.com/Woonani" role="button"><i class="bi bi-github"></i></a> -->
	    </div> 
	</footer>
	
 
</body>

</html>

